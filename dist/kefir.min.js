/*! kefir - 0.1.11
 *  https://github.com/pozadi/kefir
 */
!function(a){"use strict";function b(){}function c(a){return a}function d(a,b){return Object.prototype.hasOwnProperty.call(a,b)}function e(a){return o(a)?a:Array.prototype.slice.call(a)}function f(a){var b=function(){};return b.prototype=a,new b}function g(){if(1===arguments.length)return arguments[0];for(var a=arguments[0],b=1;b<arguments.length;b++)for(var c in arguments[b])d(arguments[b],c)&&(a[c]=arguments[b][c]);return a}function h(a,b){a.prototype=f(b.prototype),a.prototype.constructor=a;for(var c=2;c<arguments.length;c++)g(a.prototype,arguments[c]);return a}function i(a,b){for(var c in b)!d(b,c)||c in a||(a[c]=b[c]);return a}function j(a){return o(a[0])?a[0]:e(a)}function k(a,b,c){return a.length>b?Array.prototype.slice.call(a,b):c}function l(a,b){if(m(a))return a;if(null!=b&&m(b[a]))return b[a];throw new Error("not a function: "+a+" in "+b)}function m(a){return"function"==typeof a}function n(a){return"undefined"==typeof a}function o(a){return"[object Array]"===Object.prototype.toString.call(a)}function p(a,b){if(null==a&&null==b)return!0;if(null==a||null==b)return!1;if(a.length!==b.length)return!1;for(var c=0;c<a.length;c++)if(a[c]!==b[c])return!1;return!0}function q(a,b,c){return a&&b in a?a[b]:c}function r(a){if(m(a)||a instanceof r)return a;if(!o(a)&&!t(a))throw new Error("can't convert to Callable "+a);if(0===a.length)throw new Error("can't convert to Callable "+a);if(1===a.length){if(m(a[0]))return a[0];throw new Error("can't convert to Callable "+a)}this.fn=l(a[0],a[1]),this.context=a[1],this.args=k(a,2,null)}function s(a,b,c){return b?c&&0!==c.length?a.apply(b,c):a.call(b):c&&0!==c.length?1===c.length?a(c[0]):2===c.length?a(c[0],c[1]):3===c.length?a(c[0],c[1],c[2]):a.apply(null,c):a()}var t=function(a){return"[object Arguments]"===Object.prototype.toString.call(a)};t(arguments)||(t=function(a){return!(!a||!d(a,"callee"))});var u=Date.now?function(){return Date.now()}:function(){return(new Date).getTime()},v={},w=v.NOTHING=["<nothing>"],x=v.END=["<end>"],y=v.NO_MORE=["<no more>"];v.BunchOfValues=function(a){this.values=a},v.bunch=function(){return new v.BunchOfValues(j(arguments))},v.Error=function(a){this.error=a},v.error=function(a){return new v.Error(a)},r.call=function(a,b){return m(a)?s(a,null,b):a instanceof r?(a.args&&(b=b?a.args.concat(e(b)):a.args),s(a.fn,a.context,b)):r.call(new r(a),b)},r.isEqual=function(a,b){return a===b?!0:(a=new r(a),b=new r(b),a.fn===b.fn&&a.context===b.context&&p(a.args,b.args)?!0:!1)};var z=v.Observable=function(a,b){m(a)&&(this.__onFirstIn=a),m(b)&&(this.__onLastOut=b),this.__subscribers={}};h(z,Object,{__ClassName:"Observable",toString:function(){return"["+this.__ClassName+(this.__objName?" | "+this.__objName:"")+"]"},__onFirstIn:b,__onLastOut:b,__addSubscriber:function(a,b){this.__subscribers[a]||(this.__subscribers[a]=[]),this.__subscribers[a].push(new r(b))},__removeSubscriber:function(a,b){if(this.__subscribers[a])for(var c=0;c<this.__subscribers[a].length;c++)if(null!==this.__subscribers[a][c]&&r.isEqual(this.__subscribers[a][c],b))return void this.__subscribers[a].splice(c,1)},__isFirsOrLast:function(a){return!("value"!==a&&"error"!==a||this.__hasSubscribers("value")||this.__hasSubscribers("error"))},__on:function(a,b){if(this.isEnded())"end"===a&&r.call(b);else{var c=this.__isFirsOrLast(a);this.__addSubscriber(a,b),c&&this.__onFirstIn()}},__off:function(a,b){this.isEnded()||(this.__removeSubscriber(a,b),this.__isFirsOrLast(a)&&this.__onLastOut())},__send:function(a,b){if(!this.isEnded()){if(this.__subscribers[a])for(var c=this.__subscribers[a].slice(0),d=0;d<c.length;d++){var e="end"===a?null:[b];r.call(c[d],e)===y&&this.__off(a,c[d])}"end"===a&&this.__clear()}},__hasSubscribers:function(a){return!this.isEnded()&&!!this.__subscribers[a]&&this.__subscribers[a].length>0},__clear:function(){this.__onLastOut(),d(this,"__onFirstIn")&&(this.__onFirstIn=null),d(this,"__onLastOut")&&(this.__onLastOut=null),this.__subscribers=null},__sendValue:function(a){return this.__send("value",a),this},__sendError:function(a){return this.__send("error",a),this},__sendEnd:function(){return this.__send("end"),this},__sendAny:function(a){if(a===w)return this;if(a===x)return this.__sendEnd(),this;if(a instanceof v.Error)return this.__sendError(a.error),this;if(a instanceof v.BunchOfValues){for(var b=0;b<a.values.length;b++)this.__sendAny(a.values[b]);return this}return this.__sendValue(a),this},onValue:function(){return this.__on("value",arguments),this},offValue:function(){return this.__off("value",arguments),this},onError:function(){return this.__on("error",arguments),this},offError:function(){return this.__off("error",arguments),this},onEnd:function(){return this.__on("end",arguments),this},offEnd:function(){return this.__off("end",arguments),this},onNewValue:function(){return this.onValue.apply(this,arguments)},isEnded:function(){return!this.__subscribers}});var A=v.Stream=function(){z.apply(this,arguments)};h(A,z,{__ClassName:"Stream"});var B=v.Property=function(a,b,c){z.call(this,a,b),this.__cached=n(c)?w:c};h(B,z,{__ClassName:"Property",hasValue:function(){return this.__cached!==w},getValue:function(){return this.__cached},__sendValue:function(a){this.isEnded()||(this.__cached=a),z.prototype.__sendValue.call(this,a)},onNewValue:function(){return this.__on("value",arguments),this},onValue:function(){return this.hasValue()&&r.call(arguments,[this.__cached]),this.onNewValue.apply(this,arguments)}});var C=function(a,b,c){console.log(a,b,c)};z.prototype.log=function(a){return a||(a=this.toString()),this.onValue(C,null,a,"<value>"),this.onError(C,null,a,"<error>"),this.onEnd(C,null,a,"<end>"),this};var D=new A;D.__sendEnd(),D.__objName="Kefir.never()",v.never=function(){return D},v.OnceStream=function(a){A.call(this),this.__value=a},h(v.OnceStream,A,{__ClassName:"OnceStream",onValue:function(){return this.isEnded()||(r.call(arguments,[this.__value]),this.__value=null,this.__sendEnd()),this},onError:b}),v.once=function(a){return new v.OnceStream(a)},v.FromBinderStream=function(a){A.call(this),this.__subscribeFn=new r(a)},h(v.FromBinderStream,A,{__ClassName:"FromBinderStream",__onFirstIn:function(){var a=this;this.__usubscriber=r.call(this.__subscribeFn,[function(b){a.__sendAny(b)}])},__onLastOut:function(){m(this.__usubscriber)&&this.__usubscriber(),this.__usubscriber=null},__clear:function(){A.prototype.__clear.call(this),this.__subscribeFn=null}}),v.fromBinder=function(){return new v.FromBinderStream(arguments)};var E={__Constructor:function(a){this.__source=a,a.onEnd(this.__sendEnd,this),a instanceof B&&this instanceof B&&a.hasValue()&&this.__handle(a.getValue())},__handle:function(a){this.__sendAny(a)},__onFirstIn:function(){this.__source.onNewValue("__handle",this),this.__source.onError("__sendError",this)},__onLastOut:function(){this.__source.offValue("__handle",this),this.__source.offError("__sendError",this)},__clear:function(){z.prototype.__clear.call(this),this.__source=null}};v.PropertyFromStream=function(a,b){B.call(this,null,null,b),this.__Constructor(a)},h(v.PropertyFromStream,B,E,{__ClassName:"PropertyFromStream"}),A.prototype.toProperty=function(a){return new v.PropertyFromStream(this,a)},B.prototype.toProperty=function(a){if(n(a))return this;var b=new v.PropertyFromStream(this);return b.__sendValue(a),b},v.ScanProperty=function(a,b,c){B.call(this,null,null,b),this.__fn=new r(c),this.__Constructor(a)},h(v.ScanProperty,B,E,{__ClassName:"ScanProperty",__handle:function(a){this.__sendValue(r.call(this.__fn,[this.getValue(),a]))},__clear:function(){E.__clear.call(this),this.__fn=null}}),z.prototype.scan=function(a){return new v.ScanProperty(this,a,k(arguments,1))},v.ReducedProperty=function(a,b,c){B.call(this),this.__fn=new r(c),this.__result=b,a.onEnd("__sendResult",this),this.__Constructor(a)},h(v.ReducedProperty,B,E,{__ClassName:"ReducedProperty",__handle:function(a){this.__result=r.call(this.__fn,[this.__result,a])},__sendResult:function(){this.__sendValue(this.__result)},__clear:function(){E.__clear.call(this),this.__fn=null,this.__result=null}}),z.prototype.reduce=function(a){return new v.ReducedProperty(this,a,k(arguments,1))};var F={__Constructor:function(a,b){this instanceof B?B.call(this):A.call(this),this.__mapFn=b&&new r(b),E.__Constructor.call(this,a)},__handle:function(a){this.__sendAny(this.__mapFn?r.call(this.__mapFn,[a]):a)},__clear:function(){E.__clear.call(this),this.__mapFn=null}};i(F,E),v.MappedStream=function(){this.__Constructor.apply(this,arguments)},h(v.MappedStream,A,F,{__ClassName:"MappedStream"}),v.MappedProperty=function(){this.__Constructor.apply(this,arguments)},h(v.MappedProperty,B,F,{__ClassName:"MappedProperty"}),A.prototype.map=function(){return new v.MappedStream(this,arguments)},B.prototype.map=function(){return new v.MappedProperty(this,arguments)},B.prototype.changes=function(){return new v.MappedStream(this)},z.prototype.diff=function(a){var b=new r(k(arguments,1)),c=a;return this.map(function(a){var d=r.call(b,[c,a]);return c=a,d})},z.prototype.filter=function(){var a=new r(arguments);return this.map(function(b){return r.call(a,[b])?b:w})},z.prototype.takeWhile=function(){var a=new r(arguments);return this.map(function(b){return r.call(a,[b])?b:x})},z.prototype.take=function(a){return this.map(function(b){return 0>=a?x:1===a?v.bunch(b,x):(a--,b)})},z.prototype.skip=function(a){return this.map(function(b){return 0>=a?b:(a--,w)})},z.prototype.skipDuplicates=function(a){var b=w;return this.map(function(c){var d;return d=b!==w&&(a?a(b,c):b===c)?w:c,b=c,d})},z.prototype.skipWhile=function(){var a=new r(arguments),b=!0;return this.map(function(c){return b&&r.call(a,[c])?w:(b=!1,c)})};var G={__Constructor:function(a,b,c){this instanceof B?B.call(this):A.call(this),this.__transformer=c&&new r(c),this.__mainStream=a,this.__lastValue=w,a instanceof B&&a.hasValue()&&(this.__lastValue=a.getValue()),E.__Constructor.call(this,b)},__handle:function(a){if(this.__lastValue!==w){var b=this.__lastValue;this.__transformer&&(b=r.call(this.__transformer,[b,a])),this.__sendValue(b)}},__onFirstIn:function(){E.__onFirstIn.call(this),this.__mainStream.onValue("__saveValue",this),this.__mainStream.onError("__sendError",this)},__onLastOut:function(){E.__onLastOut.call(this),this.__mainStream.offValue("__saveValue",this),this.__mainStream.offError("__sendError",this)},__saveValue:function(a){this.__lastValue=a},__clear:function(){E.__clear.call(this),this.__lastValue=null,this.__fn=null,this.__mainStream=null}};i(G,E),v.SampledByStream=function(){this.__Constructor.apply(this,arguments)},h(v.SampledByStream,A,G,{__ClassName:"SampledByStream"}),v.SampledByProperty=function(){this.__Constructor.apply(this,arguments)},h(v.SampledByProperty,B,G,{__ClassName:"SampledByProperty"}),z.prototype.sampledBy=function(a){return a instanceof A?new v.SampledByStream(this,a,k(arguments,1)):new v.SampledByProperty(this,a,k(arguments,1))};var H={__initPluggable:function(){this.__plugged=[]},__clearPluggable:function(){this.__plugged=null},__handlePlugged:function(a){this.__sendAny(a)},__plug:function(a){this.isEnded()||(this.__plugged.push(a),(this.__hasSubscribers("value")||this.__hasSubscribers("error"))&&(a.onValue("__handlePlugged",this),a.onError("__sendError",this)),a.onEnd("__unplug",this,a))},__unplug:function(a){if(!this.isEnded())for(var b=0;b<this.__plugged.length;b++)if(a===this.__plugged[b])return a.offValue("__handlePlugged",this),a.offError("__sendError",this),a.offEnd("__unplug",this,a),void this.__plugged.splice(b,1)},__onFirstIn:function(){for(var a=0;a<this.__plugged.length;a++){var b=this.__plugged[a];b&&(b.onValue("__handlePlugged",this),b.onError("__sendError",this))}},__onLastOut:function(){for(var a=0;a<this.__plugged.length;a++){var b=this.__plugged[a];b&&(b.offValue("__handlePlugged",this),b.offError("__sendError",this))}},__hasNoPlugged:function(){return this.isEnded()||0===this.__plugged.length}};v.Bus=function(){A.call(this),this.__initPluggable()},h(v.Bus,A,H,{__ClassName:"Bus",push:function(a){return this.__sendAny(a),this},error:function(a){return this.__sendError(a),this},plug:function(a){return this.__plug(a),this},unplug:function(a){return this.__unplug(a),this},end:function(){return this.__sendEnd(),this},__clear:function(){A.prototype.__clear.call(this),this.__clearPluggable(),this.push=b}}),v.bus=function(){return new v.Bus},v.FlatMappedStream=function(a,b){A.call(this),this.__initPluggable(),this.__sourceStream=a,this.__mapFn=new r(b),a.onEnd(this.__onSourceEnds,this)},h(v.FlatMappedStream,A,H,{__ClassName:"FlatMappedStream",__onSourceEnds:function(){this.__hasNoPlugged()&&this.__sendEnd()},__plugResult:function(a){this.__plug(r.call(this.__mapFn,[a]))},__onFirstIn:function(){this.__sourceStream.onValue("__plugResult",this),this.__sourceStream.onError("__sendError",this),H.__onFirstIn.call(this)},__onLastOut:function(){this.__sourceStream.offValue("__plugResult",this),this.__sourceStream.offError("__sendError",this),H.__onLastOut.call(this)},__unplug:function(a){H.__unplug.call(this,a),!this.isEnded()&&this.__sourceStream.isEnded()&&this.__hasNoPlugged()&&this.__sendEnd()},__clear:function(){A.prototype.__clear.call(this),this.__clearPluggable(),this.__sourceStream=null,this.__mapFn=null}}),z.prototype.flatMap=function(){return new v.FlatMappedStream(this,arguments)},v.FlatMapLatestStream=function(){v.FlatMappedStream.apply(this,arguments)},h(v.FlatMapLatestStream,v.FlatMappedStream,{__ClassName:"FlatMapLatestStream",__plugResult:function(a){1===this.__plugged.length&&this.__unplug(this.__plugged[0]),v.FlatMappedStream.prototype.__plugResult.call(this,a)}}),z.prototype.flatMapLatest=function(){return new v.FlatMapLatestStream(this,arguments)},v.MergedStream=function(){A.call(this),this.__initPluggable();for(var a=j(arguments),b=0;b<a.length;b++)this.__plug(a[b])},h(v.MergedStream,A,H,{__ClassName:"MergedStream",__clear:function(){A.prototype.__clear.call(this),this.__clearPluggable()},__unplug:function(a){H.__unplug.call(this,a),this.__hasNoPlugged()&&this.__sendEnd()}}),v.merge=function(){return new v.MergedStream(j(arguments))},z.prototype.merge=function(){return v.merge([this].concat(j(arguments)))},v.CombinedStream=function(a,b){A.call(this),this.__plugged=a;for(var c=0;c<this.__plugged.length;c++)a[c].onEnd("__unplugById",this,c);this.__cachedValues=new Array(a.length),this.__hasValue=new Array(a.length),this.__mapFn=b&&new r(b)},h(v.CombinedStream,A,{__ClassName:"CombinedStream",__onFirstIn:function(){for(var a=0;a<this.__plugged.length;a++){var b=this.__plugged[a];b&&(b.onValue("__handlePlugged",this,a),b.onError("__sendError",this))}},__onLastOut:function(){for(var a=0;a<this.__plugged.length;a++){var b=this.__plugged[a];b&&(b.offValue("__handlePlugged",this,a),b.offError("__sendError",this))}},__hasNoPlugged:function(){if(this.isEnded())return!0;for(var a=0;a<this.__plugged.length;a++)if(this.__plugged[a])return!1;return!0},__unplugById:function(a){var b=this.__plugged[a];b&&(this.__plugged[a]=null,b.offValue("__handlePlugged",this,a),b.offError("__sendError",this),b.offEnd("__unplugById",this,a),this.__hasNoPlugged()&&this.__sendEnd())},__handlePlugged:function(a,b){this.__hasValue[a]=!0,this.__cachedValues[a]=b,this.__allCached()&&(this.__mapFn?this.__sendAny(r.call(this.__mapFn,this.__cachedValues)):this.__sendValue(this.__cachedValues.slice(0)))},__allCached:function(){for(var a=0;a<this.__hasValue.length;a++)if(!this.__hasValue[a])return!1;return!0},__clear:function(){A.prototype.__clear.call(this),this.__plugged=null,this.__cachedValues=null,this.__hasValue=null,this.__mapFn=null}}),v.combine=function(a){return new v.CombinedStream(a,k(arguments,1))},z.prototype.combine=function(a){return new v.CombinedStream([this].concat(a),k(arguments,1))},v.onValues=function(a){var b=new r(k(arguments,1));return v.combine(a).onValue(function(a){return r.call(b,a)})},v.LaterStream=function(a,b){A.call(this),this.__value=b,this.__wait=a},h(v.LaterStream,A,{__ClassName:"LaterStream",__onFirstIn:function(){var a=this;setTimeout(function(){a.__sendAny(a.__value),a.__sendEnd()},this.__wait)},__clear:function(){A.prototype.__clear.call(this),this.__value=null,this.__wait=null}}),v.later=function(a,b){return new v.LaterStream(a,b)};var I={__Constructor:function(a,b){this.__source=a,this.__wait=b,a.onEnd(this.__sendEndLater,this)},__sendLater:function(a){var b=this;setTimeout(function(){b.__sendValue(a)},this.__wait)},__sendEndLater:function(){var a=this;setTimeout(function(){a.__sendEnd()},this.__wait)},__onFirstIn:function(){this.__source.onNewValue("__sendLater",this),this.__source.onError("__sendError",this)},__onLastOut:function(){this.__source.offValue("__sendLater",this),this.__source.offError("__sendError",this)},__clear:function(){z.prototype.__clear.call(this),this.__source=null,this.__wait=null}};v.DelayedStream=function(a,b){A.call(this),I.__Constructor.call(this,a,b)},h(v.DelayedStream,A,I,{__ClassName:"DelayedStream"}),A.prototype.delay=function(a){return new v.DelayedStream(this,a)},v.DelayedProperty=function(a,b){B.call(this),I.__Constructor.call(this,a,b),a.hasValue()&&this.__sendValue(a.getValue())},h(v.DelayedProperty,B,I,{__ClassName:"DelayedProperty"}),B.prototype.delay=function(a){return new v.DelayedProperty(this,a)};var J={__Constructor:function(a,b,c){this.__source=a,this.__wait=b,this.__trailingCallValue=null,this.__trailingCallTimeoutId=null,this.__endAfterTrailingCall=!1,this.__lastCallTime=0,this.__leading=q(c,"leading",!0),this.__trailing=q(c,"trailing",!0);var d=this;this.__makeTrailingCallBinded=function(){d.__makeTrailingCall()},a.onEnd(this.__sendEndLater,this)},__sendEndLater:function(){this.__trailingCallTimeoutId?this.__endAfterTrailingCall=!0:this.__sendEnd()},__scheduleTralingCall:function(a,b){this.__trailingCallTimeoutId&&this.__cancelTralingCall(),this.__trailingCallValue=a,this.__trailingCallTimeoutId=setTimeout(this.__makeTrailingCallBinded,b)},__cancelTralingCall:function(){null!==this.__trailingCallTimeoutId&&(clearTimeout(this.__trailingCallTimeoutId),this.__trailingCallTimeoutId=null)},__makeTrailingCall:function(){this.__sendValue(this.__trailingCallValue),this.__trailingCallTimeoutId=null,this.__trailingCallValue=null,this.__lastCallTime=this.__leading?u():0,this.__endAfterTrailingCall&&this.__sendEnd()},__handleValueFromSource:function(a){var b=u();0!==this.__lastCallTime||this.__leading||(this.__lastCallTime=b);var c=this.__wait-(b-this.__lastCallTime);0>=c?(this.__cancelTralingCall(),this.__lastCallTime=b,this.__sendValue(a)):this.__trailing&&this.__scheduleTralingCall(a,c)},__onFirstIn:function(){this.__source.onNewValue("__handleValueFromSource",this),this.__source.onError("__sendError",this)},__onLastOut:function(){this.__source.offValue("__handleValueFromSource",this),this.__source.offError("__sendError",this)},__clear:function(){z.prototype.__clear.call(this),this.__source=null,this.__wait=null,this.__trailingCallValue=null,this.__trailingCallTimeoutId=null,this.__makeTrailingCallBinded=null}};v.ThrottledStream=function(){A.call(this),J.__Constructor.apply(this,arguments)},h(v.ThrottledStream,A,J,{__ClassName:"ThrottledStream"}),A.prototype.throttle=function(a,b){return new v.ThrottledStream(this,a,b)},v.ThrottledProperty=function(a){B.call(this),J.__Constructor.apply(this,arguments),a.hasValue()&&this.__sendValue(a.getValue())},h(v.ThrottledProperty,B,J,{__ClassName:"ThrottledProperty"}),B.prototype.throttle=function(a,b){return new v.ThrottledProperty(this,a,b)};var K=v.FromPollStream=function(a,b){A.call(this),this.__interval=a,this.__intervalId=null;var c=this;b=new r(b),this.__bindedSend=function(){c.__sendAny(r.call(b))}};h(K,A,{__ClassName:"FromPollStream",__onFirstIn:function(){this.__intervalId=setInterval(this.__bindedSend,this.__interval)},__onLastOut:function(){null!==this.__intervalId&&(clearInterval(this.__intervalId),this.__intervalId=null)},__clear:function(){A.prototype.__clear.call(this),this.__bindedSend=null}}),v.fromPoll=function(a){return new K(a,k(arguments,1))},v.interval=function(a,b){return new K(a,[c,null,b])};var L=function(){return 0===this.xs.length?x:1===this.xs.length?v.bunch(this.xs[0],x):this.xs.shift()};v.sequentially=function(a,b){return new K(a,[L,{xs:b.slice(0)}])};var M=function(){return this.i=(this.i+1)%this.xs.length,this.xs[this.i]};v.repeatedly=function(a,b){return new K(a,[M,{i:-1,xs:b}])},"function"==typeof define&&define.amd?(define([],function(){return v}),a.Kefir=v):"object"==typeof module&&"object"==typeof exports?(module.exports=v,v.Kefir=v):a.Kefir=v}(this);