/*! kefir - 0.1.10
 *  https://github.com/pozadi/kefir
 */
!function(a){"use strict";function b(){}function c(a){return a}function d(a,b){return Object.prototype.hasOwnProperty.call(a,b)}function e(a){return q(a)?a:Array.prototype.slice.call(a)}function f(a){var b=function(){};return b.prototype=a,new b}function g(){if(1===arguments.length)return arguments[0];for(var a=arguments[0],b=1;b<arguments.length;b++)for(var c in arguments[b])d(arguments[b],c)&&(a[c]=arguments[b][c]);return a}function h(a,b){a.prototype=f(b.prototype),a.prototype.constructor=a;for(var c=2;c<arguments.length;c++)g(a.prototype,arguments[c]);return a}function i(a,b){for(var c in b)!d(b,c)||c in a||(a[c]=b[c]);return a}function j(a){return q(a[0])?a[0]:e(a)}function k(a,b,c){return a.length>b?Array.prototype.slice.call(a,b):c?null:[]}function l(a,b){if(o(a))return a;if(null!=b&&o(b[a]))return b[a];throw new Error("not a function: "+a+" in "+b)}function m(a,b){var c,d,f;return o(a)?(c=a,d=null,f=null):(d=a[1],c=l(a[0],d),f=k(a,2,!0)),b&&(f=f?f.concat(e(b)):b),f?c.apply(d,f):c.call(d)}function n(a){if(q(a)||s(a)){if(1===a.length)return a[0];if(0===a.length)return null}return a}function o(a){return"function"==typeof a}function p(a){return"undefined"==typeof a}function q(a){return"[object Array]"===Object.prototype.toString.call(a)}function r(a,b){if(null==a&&null==b)return!0;if(null==a||null==b)return!1;if(a.length!==b.length)return!1;for(var c=0;c<a.length;c++)if(a[c]!==b[c])return!1;return!0}var s=function(a){return"[object Arguments]"===Object.prototype.toString.call(a)};s(arguments)||(s=function(a){return!(!a||!d(a,"callee"))});var t={},u=t.NOTHING=["<nothing>"],v=t.END=["<end>"],w=t.NO_MORE=["<no more>"];t.BunchOfValues=function(a){this.values=a},t.bunch=function(){return new t.BunchOfValues(j(arguments))},t.Error=function(a){this.error=a},t.error=function(a){return new t.Error(a)};var x=t.Observable=function(a,b){o(a)&&(this.__onFirstIn=a),o(b)&&(this.__onLastOut=b),this.__subscribers=[]};h(x,Object,{__ClassName:"Observable",toString:function(){return"["+this.__ClassName+(this.__objName?" | "+this.__objName:"")+"]"},__onFirstIn:b,__onLastOut:b,__on:function(a){if(this.isEnded())"end"===a&&m(k(arguments,1));else{var b=("value"===a||"error"===a)&&!(this.__hasSubscribers("value")||this.__hasSubscribers("error"));this.__subscribers.push(arguments),b&&this.__onFirstIn()}},__off:function(a){if(!this.isEnded()){for(var b=0;b<this.__subscribers.length;b++)r(this.__subscribers[b],arguments)&&(this.__subscribers[b]=null);"value"!==a&&"error"!==a||this.__hasSubscribers("value")||this.__hasSubscribers("error")||this.__onLastOut()}},__send:function(a){if(!this.isEnded()){for(var b=0;b<this.__subscribers.length;b++){var c=this.__subscribers[b];if(c&&c[0]===a){var d=m(k(c,1),k(arguments,1));d===w&&this.__off.apply(this,c)}}"end"===a&&this.__clear()}},__hasSubscribers:function(a){if(this.isEnded())return!1;for(var b=0;b<this.__subscribers.length;b++)if(this.__subscribers[b]&&this.__subscribers[b][0]===a)return!0;return!1},__clear:function(){this.__onLastOut(),d(this,"__onFirstIn")&&(this.__onFirstIn=null),d(this,"__onLastOut")&&(this.__onLastOut=null),this.__subscribers=null},__sendValue:function(a){return this.__send("value",a),this},__sendError:function(a){return this.__send("error",a),this},__sendEnd:function(){return this.__send("end"),this},__sendAny:function(a){if(a===v)this.__sendEnd();else if(a instanceof t.BunchOfValues)for(var b=0;b<a.values.length;b++)this.__sendAny(a.values[b]);else a instanceof t.Error?this.__sendError(a.error):a!==u&&this.__sendValue(a);return this},onValue:function(){return this.__on.apply(this,["value"].concat(e(arguments))),this},offValue:function(){return this.__off.apply(this,["value"].concat(e(arguments))),this},onError:function(){return this.__on.apply(this,["error"].concat(e(arguments))),this},offError:function(){return this.__off.apply(this,["error"].concat(e(arguments))),this},onEnd:function(){return this.__on.apply(this,["end"].concat(e(arguments))),this},offEnd:function(){return this.__off.apply(this,["end"].concat(e(arguments))),this},onNewValue:function(){return this.onValue.apply(this,arguments)},isEnded:function(){return!this.__subscribers}});var y=t.Stream=function(){x.apply(this,arguments)};h(y,x,{__ClassName:"Stream"});var z=t.Property=function(a,b,c){x.call(this,a,b),this.__cached=p(c)?u:c};h(z,x,{__ClassName:"Property",hasValue:function(){return this.__cached!==u},getValue:function(){return this.__cached},__sendValue:function(a){this.isEnded()||(this.__cached=a),x.prototype.__sendValue.call(this,a)},onNewValue:function(){return this.__on.apply(this,["value"].concat(e(arguments))),this},onValue:function(){return this.hasValue()&&m(arguments,[this.__cached]),this.onNewValue.apply(this,arguments)}});var A=function(a,b,c){console.log(a,b,c)};x.prototype.log=function(a){return a||(a=this.toString()),this.onValue(A,null,a,"<value>"),this.onError(A,null,a,"<error>"),this.onEnd(A,null,a,"<end>"),this};var B=new y;B.__sendEnd(),B.__objName="Kefir.never()",t.never=function(){return B},t.OnceStream=function(a){y.call(this),this.__value=a},h(t.OnceStream,y,{__ClassName:"OnceStream",onValue:function(){return this.isEnded()||(m(arguments,[this.__value]),this.__value=null,this.__sendEnd()),this},onError:b}),t.once=function(a){return new t.OnceStream(a)},t.FromBinderStream=function(a){y.call(this),this.__subscribeFnMeta=n(a)},h(t.FromBinderStream,y,{__ClassName:"FromBinderStream",__onFirstIn:function(){var a=this;this.__usubscriber=m(this.__subscribeFnMeta,[function(b){a.__sendAny(b)}])},__onLastOut:function(){o(this.__usubscriber)&&this.__usubscriber(),this.__usubscriber=null},__clear:function(){y.prototype.__clear.call(this),this.__subscribeFnMeta=null}}),t.fromBinder=function(){return new t.FromBinderStream(arguments)};var C={__Constructor:function(a){this.__source=a,a.onEnd(this.__sendEnd,this),a instanceof z&&this instanceof z&&a.hasValue()&&this.__handle(a.getValue())},__handle:function(a){this.__sendAny(a)},__onFirstIn:function(){this.__source.onNewValue("__handle",this),this.__source.onError("__sendError",this)},__onLastOut:function(){this.__source.offValue("__handle",this),this.__source.offError("__sendError",this)},__clear:function(){x.prototype.__clear.call(this),this.__source=null}};t.PropertyFromStream=function(a,b){z.call(this,null,null,b),this.__Constructor(a)},h(t.PropertyFromStream,z,C,{__ClassName:"PropertyFromStream"}),y.prototype.toProperty=function(a){return new t.PropertyFromStream(this,a)},z.prototype.toProperty=function(a){if(p(a))return this;var b=new t.PropertyFromStream(this);return b.__sendValue(a),b},t.ScanProperty=function(a,b,c){z.call(this,null,null,b),this.__fnMeta=n(c),this.__Constructor(a)},h(t.ScanProperty,z,C,{__ClassName:"ScanProperty",__handle:function(a){this.__sendValue(m(this.__fnMeta,[this.getValue(),a]))},__clear:function(){C.__clear.call(this),this.__fnMeta=null}}),x.prototype.scan=function(a){return new t.ScanProperty(this,a,k(arguments,1))},t.ReducedProperty=function(a,b,c){z.call(this),this.__fnMeta=n(c),this.__result=b,a.onEnd("__sendResult",this),this.__Constructor(a)},h(t.ReducedProperty,z,C,{__ClassName:"ReducedProperty",__handle:function(a){this.__result=m(this.__fnMeta,[this.__result,a])},__sendResult:function(){this.__sendValue(this.__result)},__clear:function(){C.__clear.call(this),this.__fnMeta=null,this.__result=null}}),x.prototype.reduce=function(a){return new t.ReducedProperty(this,a,k(arguments,1))};var D={__Constructor:function(a,b){this instanceof z?z.call(this):y.call(this),this.__mapFnMeta=n(b),C.__Constructor.call(this,a)},__handle:function(a){this.__sendAny(this.__mapFnMeta?m(this.__mapFnMeta,[a]):a)},__clear:function(){C.__clear.call(this),this.__mapFnMeta=null}};i(D,C),t.MappedStream=function(){this.__Constructor.apply(this,arguments)},h(t.MappedStream,y,D,{__ClassName:"MappedStream"}),t.MappedProperty=function(){this.__Constructor.apply(this,arguments)},h(t.MappedProperty,z,D,{__ClassName:"MappedProperty"}),y.prototype.map=function(){return new t.MappedStream(this,arguments)},z.prototype.map=function(){return new t.MappedProperty(this,arguments)},z.prototype.changes=function(){return new t.MappedStream(this)};var E=function(a){var b=m(this.fnMeta,[this.prev,a]);return this.prev=a,b};x.prototype.diff=function(a){return this.map(E,{prev:a,fnMeta:n(k(arguments,1))})};var F=function(a,b){return m(a,[b])?b:u};x.prototype.filter=function(){return this.map(F,null,n(arguments))};var G=function(a,b){return m(a,[b])?b:v};x.prototype.takeWhile=function(){return this.map(G,null,n(arguments))};var H=function(a){return this.n<=0?v:1===this.n?t.bunch(a,v):(this.n--,a)};x.prototype.take=function(a){return this.map(H,{n:a})};var I=function(a){return this.n<=0?a:(this.n--,u)};x.prototype.skip=function(a){return this.map(I,{n:a})};var J=function(a){var b;return b=this.prev!==u&&(this.fn?this.fn(this.prev,a):this.prev===a)?u:a,this.hasPrev=!0,this.prev=a,b};x.prototype.skipDuplicates=function(a){return this.map(J,{fn:a,prev:u})};var K=function(a){return this.skip&&m(this.fnMeta,[a])?u:(this.skip=!1,a)};x.prototype.skipWhile=function(){return this.map(K,{skip:!0,fnMeta:n(arguments)})};var L={__Constructor:function(a,b,c){this instanceof z?z.call(this):y.call(this),this.__fnMeta=n(c),this.__mainStream=a,this.__lastValue=u,a instanceof z&&a.hasValue()&&(this.__lastValue=a.getValue()),C.__Constructor.call(this,b)},__handle:function(a){if(this.__lastValue!==u){var b=this.__lastValue;this.__fnMeta&&(b=m(this.__fnMeta,[b,a])),this.__sendValue(b)}},__onFirstIn:function(){C.__onFirstIn.call(this),this.__mainStream.onValue("__saveValue",this),this.__mainStream.onError("__sendError",this)},__onLastOut:function(){C.__onLastOut.call(this),this.__mainStream.offValue("__saveValue",this),this.__mainStream.offError("__sendError",this)},__saveValue:function(a){this.__lastValue=a},__clear:function(){C.__clear.call(this),this.__lastValue=null,this.__fn=null,this.__mainStream=null}};i(L,C),t.SampledByStream=function(){this.__Constructor.apply(this,arguments)},h(t.SampledByStream,y,L,{__ClassName:"SampledByStream"}),t.SampledByProperty=function(){this.__Constructor.apply(this,arguments)},h(t.SampledByProperty,z,L,{__ClassName:"SampledByProperty"}),x.prototype.sampledBy=function(a){return a instanceof y?new t.SampledByStream(this,a,k(arguments,1)):new t.SampledByProperty(this,a,k(arguments,1))};var M={__initPluggable:function(){this.__plugged=[]},__clearPluggable:function(){this.__plugged=null},__handlePlugged:function(a,b){this.__sendAny(b)},__plug:function(a){if(!this.isEnded()){this.__plugged.push(a);var b=this.__plugged.length-1;this.__hasSubscribers("value")&&(a.onValue("__handlePlugged",this,b),a.onError("__sendError",this)),a.onEnd("__unplugById",this,b)}},__unplugById:function(a){if(!this.isEnded()){var b=this.__plugged[a];b&&(this.__plugged[a]=null,b.offValue("__handlePlugged",this,a),b.offError("__sendError",this),b.offEnd("__unplugById",this,a))}},__unplug:function(a){if(!this.isEnded())for(var b=0;b<this.__plugged.length;b++)this.__plugged[b]===a&&this.__unplugById(b)},__onFirstIn:function(){for(var a=0;a<this.__plugged.length;a++){var b=this.__plugged[a];b&&(b.onValue("__handlePlugged",this,a),b.onError("__sendError",this))}},__onLastOut:function(){for(var a=0;a<this.__plugged.length;a++){var b=this.__plugged[a];b&&(b.offValue("__handlePlugged",this,a),b.offError("__sendError",this))}},__hasNoPlugged:function(){if(this.isEnded())return!0;for(var a=0;a<this.__plugged.length;a++)if(this.__plugged[a])return!1;return!0}};t.Bus=function(){y.call(this),this.__initPluggable()},h(t.Bus,y,M,{__ClassName:"Bus",push:function(a){return this.__sendAny(a),this},error:function(a){return this.__sendError(a),this},plug:function(a){return this.__plug(a),this},unplug:function(a){return this.__unplug(a),this},end:function(){return this.__sendEnd(),this},__clear:function(){y.prototype.__clear.call(this),this.__clearPluggable(),this.push=b}}),t.bus=function(){return new t.Bus},t.FlatMappedStream=function(a,b){y.call(this),this.__initPluggable(),this.__sourceStream=a,this.__mapFnMeta=n(b),a.onEnd(this.__onSourceEnds,this)},h(t.FlatMappedStream,y,M,{__ClassName:"FlatMappedStream",__onSourceEnds:function(){this.__hasNoPlugged()&&this.__sendEnd()},__plugResult:function(a){this.__plug(m(this.__mapFnMeta,[a]))},__onFirstIn:function(){this.__sourceStream.onValue("__plugResult",this),this.__sourceStream.onError("__sendError",this),M.__onFirstIn.call(this)},__onLastOut:function(){this.__sourceStream.offValue("__plugResult",this),this.__sourceStream.offError("__sendError",this),M.__onLastOut.call(this)},__unplugById:function(a){M.__unplugById.call(this,a),!this.isEnded()&&this.__hasNoPlugged()&&this.__sourceStream.isEnded()&&this.__sendEnd()},__clear:function(){y.prototype.__clear.call(this),this.__clearPluggable(),this.__sourceStream=null,this.__mapFnMeta=null}}),x.prototype.flatMap=function(){return new t.FlatMappedStream(this,arguments)},t.FlatMapLatestStream=function(){t.FlatMappedStream.apply(this,arguments)},h(t.FlatMapLatestStream,t.FlatMappedStream,{__ClassName:"FlatMapLatestStream",__plugResult:function(a){for(var b=0;b<this.__plugged.length;b++)this.__unplugById(b);t.FlatMappedStream.prototype.__plugResult.call(this,a)}}),x.prototype.flatMapLatest=function(){return new t.FlatMapLatestStream(this,arguments)},t.MergedStream=function(){y.call(this),this.__initPluggable();for(var a=j(arguments),b=0;b<a.length;b++)this.__plug(a[b])},h(t.MergedStream,y,M,{__ClassName:"MergedStream",__clear:function(){y.prototype.__clear.call(this),this.__clearPluggable()},__unplugById:function(a){M.__unplugById.call(this,a),this.__hasNoPlugged()&&this.__sendEnd()}}),t.merge=function(){return new t.MergedStream(j(arguments))},x.prototype.merge=function(){return t.merge([this].concat(j(arguments)))},t.CombinedStream=function(a,b){y.call(this),this.__initPluggable();for(var c=0;c<a.length;c++)this.__plug(a[c]);this.__cachedValues=new Array(a.length),this.__hasValue=new Array(a.length),this.__mapFnMeta=n(b)},h(t.CombinedStream,y,M,{__ClassName:"CombinedStream",__unplugById:function(a){M.__unplugById.call(this,a),this.__hasNoPlugged()&&this.__sendEnd()},__handlePlugged:function(a,b){this.__hasValue[a]=!0,this.__cachedValues[a]=b,this.__allCached()&&(this.__mapFnMeta?this.__sendAny(m(this.__mapFnMeta,this.__cachedValues)):this.__sendValue(this.__cachedValues.slice(0)))},__allCached:function(){for(var a=0;a<this.__hasValue.length;a++)if(!this.__hasValue[a])return!1;return!0},__clear:function(){y.prototype.__clear.call(this),this.__clearPluggable(),this.__cachedValues=null,this.__hasValue=null,this.__mapFnMeta=null}}),t.combine=function(a){return new t.CombinedStream(a,k(arguments,1))},x.prototype.combine=function(a){return new t.CombinedStream([this].concat(a),k(arguments,1))},t.onValues=function(a){var b=n(k(arguments,1));return t.combine(a).onValue(m,null,b)},t.LaterStream=function(a,b){y.call(this),this.__value=b,this.__wait=a},h(t.LaterStream,y,{__ClassName:"LaterStream",__onFirstIn:function(){var a=this;setTimeout(function(){a.__sendAny(a.__value),a.__sendEnd()},this.__wait)},__clear:function(){y.prototype.__clear.call(this),this.__value=null,this.__wait=null}}),t.later=function(a,b){return new t.LaterStream(a,b)};var N={__Constructor:function(a,b){this.__source=a,this.__wait=b,a.onEnd(this.__sendEndLater,this)},__sendLater:function(a){var b=this;setTimeout(function(){b.__sendValue(a)},this.__wait)},__sendEndLater:function(){var a=this;setTimeout(function(){a.__sendEnd()},this.__wait)},__onFirstIn:function(){this.__source.onNewValue("__sendLater",this),this.__source.onError("__sendError",this)},__onLastOut:function(){this.__source.offValue("__sendLater",this),this.__source.offError("__sendError",this)},__clear:function(){x.prototype.__clear.call(this),this.__source=null,this.__wait=null}};t.DelayedStream=function(a,b){y.call(this),N.__Constructor.call(this,a,b)},h(t.DelayedStream,y,N,{__ClassName:"DelayedStream"}),y.prototype.delay=function(a){return new t.DelayedStream(this,a)},t.DelayedProperty=function(a,b){z.call(this),N.__Constructor.call(this,a,b),a.hasValue()&&this.__sendValue(a.getValue())},h(t.DelayedProperty,z,N,{__ClassName:"DelayedProperty"}),z.prototype.delay=function(a){return new t.DelayedProperty(this,a)};var O=t.FromPollStream=function(a,b){y.call(this),this.__interval=a,this.__intervalId=null;var c=this;b=n(b),this.__bindedSend=function(){c.__sendAny(m(b))}};h(O,y,{__ClassName:"FromPollStream",__onFirstIn:function(){this.__intervalId=setInterval(this.__bindedSend,this.__interval)},__onLastOut:function(){null!==this.__intervalId&&(clearInterval(this.__intervalId),this.__intervalId=null)},__clear:function(){y.prototype.__clear.call(this),this.__bindedSend=null}}),t.fromPoll=function(a){return new O(a,k(arguments,1))},t.interval=function(a,b){return new O(a,[c,null,b])};var P=function(){return 0===this.xs.length?v:1===this.xs.length?t.bunch(this.xs[0],v):this.xs.shift()};t.sequentially=function(a,b){return new O(a,[P,{xs:b.slice(0)}])};var Q=function(){return this.i=(this.i+1)%this.xs.length,this.xs[this.i]};t.repeatedly=function(a,b){return new O(a,[Q,{i:-1,xs:b}])},"function"==typeof define&&define.amd?(define([],function(){return t}),a.Kefir=t):"object"==typeof module&&"object"==typeof exports?(module.exports=t,t.Kefir=t):a.Kefir=t}(this);