/*! kefir - 0.1.12
 *  https://github.com/pozadi/kefir
 */
!function(a){"use strict";function b(a){return a}function c(a,b,c){return a&&b in a?a[b]:c}function d(a,b){return Object.prototype.hasOwnProperty.call(a,b)}function e(a){var b=function(){};return b.prototype=a,new b}function f(){var a,b,c,e=arguments.length;if(1===e)return arguments[0];for(a=arguments[0],b=1;e>b;b++)for(c in arguments[b])d(arguments[b],c)&&(a[c]=arguments[b][c]);return a}function g(a,b){var c,d=arguments.length;for(a.prototype=e(b.prototype),a.prototype.constructor=a,c=2;d>c;c++)f(a.prototype,arguments[c]);return a}function h(a){return 1===a.length&&q(a[0])?a[0]:n(a)}function i(a,b){if(p(a))return a;if(null!=b&&p(b[a]))return b[a];throw new Error("not a function: "+a+" in "+b)}function j(a,b,c){if(null!=b)return c&&0!==c.length?a.apply(b,c):a.call(b);if(!c||0===c.length)return a();switch(c.length){case 1:return a(c[0]);case 2:return a(c[0],c[1]);case 3:return a(c[0],c[1],c[2])}return a.apply(null,c)}function k(a,b){var c,d,e=new Array(a.length+b.length),f=0;for(c=a.length,d=0;c>d;d++,f++)e[f]=a[d];for(c=b.length,d=0;c>d;d++,f++)e[f]=b[d];return e}function l(a){var b,c=a.length,d=new Array(c);for(b=0;c>b;b++)d[b]=a[b];return d}function m(a,b,c){return a.length>b?Array.prototype.slice.call(a,b):c}function n(a){return q(a)?a:l(a)}function o(a){return a.charAt(0).toUpperCase()+a.slice(1)}function p(a){return"function"==typeof a}function q(a){return"[object Array]"===Object.prototype.toString.call(a)}function r(a,b){var c,d;if(null==a&&null==b)return!0;if(null==a||null==b)return!1;if(a.length!==b.length)return!1;for(d=0,c=a.length;c>d;d++)if(a[d]!==b[d])return!1;return!0}function s(a){if(p(a)||a instanceof s)return a;if(!a||!a.length)throw new Error("can't convert to Callable "+a);if(1===a.length){if(p(a[0]))return a[0];throw new Error("can't convert to Callable "+a)}this.fn=i(a[0],a[1]),this.context=a[1],this.args=m(a,2,null)}function t(){this.value=[],this.error=[],this.both=[],this.end=[]}function u(){this.__subscribers=new t,this.__ended=!1,this.__active=!1,this.__current={value:H,error:H}}function v(a){u.call(this),this.__fn=new s(a)}function w(){u.call(this)}function x(a){u.call(this),this.__send("value",a),this.__send("end")}function y(a){u.call(this),this.__send("error",a),this.__send("end")}function z(a,b){return a===b}function A(a,b){function c(a,b){u.call(this),this.__source=a,this.__init(b),this.__ended||this.__source.on("end",[this.__handleEnd,this]),!this.__ended&&this.__source.has("value")&&this.__handleValue(this.__source.get("value"),!0),!this.__ended&&this.__source.has("error")&&this.__handleError(this.__source.get("error"),!0)}g(c,u,{__name:o(a)+"Property",__init:function(){},__free:function(){},__handleValue:function(a){this.__send("value",a)},__handleError:function(a){this.__send("error",a)},__handleEnd:function(){this.__send("end")},__handleBoth:function(a,b){"value"===a?this.__handleValue(b):this.__handleError(b)},__onActivation:function(){this.__source.on("both",[this.__handleBoth,this])},__onDeactivation:function(){this.__source.off("both",[this.__handleBoth,this])},__clear:function(){u.prototype.__clear.call(this),this.__source=null,this.__free()}},b),u.prototype[a]=function(){return new c(this,arguments)}}function B(){M.apply(this,arguments)}function C(a){for(var b=0;b<a.length;b++)if(!a[b].has("value"))return!1;return!0}function D(a){for(var b=new Array(a.length),c=0;c<a.length;c++)b[c]=a[c].get("value");return b}function E(a,b,c){function d(a){u.call(this),this.__multSubscriber=new F([this.__handleBoth,this]),this.__init(a)}return g(d,u,{__name:o(a)+"Property",__init:function(){},__free:function(){},__onActivationHook:function(){},__onDeactivationHook:function(){},__handleValue:function(a){this.__send("value",a)},__handleError:function(a){this.__send("error",a)},__handleBoth:function(a,b,c){"value"===a?this.__handleValue(b,c):this.__handleError(b,c)},__onActivation:function(){this.__multSubscriber.start(),this.__onActivationHook()},__onDeactivation:function(){this.__multSubscriber.stop(),this.__onDeactivationHook()},__clear:function(){u.prototype.__clear.call(this),this.__multSubscriber.clear(),this.__multSubscriber=null,this.__free()}},b),c||(K[a]=function(){return new d(arguments)}),d}function F(a){this.listener=new s(a),this.properties=[],this.active=!1}function G(a,b){function c(a,b){u.call(this),this.__wait=a,this.__intervalId=null;var c=this;this.__bindedOnTick=function(){c.__onTick()},this.__init(b)}g(c,u,{__name:o(a)+"Property",__init:function(){},__free:function(){},__onTick:function(){},__onActivation:function(){this.__intervalId=setInterval(this.__bindedOnTick,this.__wait)},__onDeactivation:function(){null!==this.__intervalId&&(clearInterval(this.__intervalId),this.__intervalId=null)},__clear:function(){u.prototype.__clear.call(this),this.__bindedOnTick=null,this.__free()}},b),K[a]=function(a){return new c(a,m(arguments,1,[]))}}var H=["<nothing>"],I=Date.now?function(){return Date.now()}:function(){return(new Date).getTime()},J=function(a){return"[object Arguments]"===Object.prototype.toString.call(a)};J(arguments)||(J=function(a){return!(!a||!d(a,"callee"))});var K={};s.call=function(a,b){return p(a)?j(a,null,b):a instanceof s?(a.args&&(b=b?k(a.args,b):a.args),j(a.fn,a.context,b)):s.call(new s(a),b)},s.isEqual=function(a,b){return a===b?!0:(a=new s(a),b=new s(b),p(a)||p(b)?a===b:a.fn===b.fn&&a.context===b.context&&r(a.args,b.args))},f(t.prototype,{add:function(a,b){this[a].push(new s(b))},remove:function(a,b){var c,d=new s(b),e=this[a],f=e.length;for(c=0;f>c;c++)if(s.isEqual(e[c],d))return void e.splice(c,1)},call:function(a,b){var c,d=this[a],e=d.length;if(0!==e)if(1===e)s.call(d[0],b);else for(d=l(d),c=0;e>c;c++)s.call(d[c],b)},hasValueOrError:function(){return this.value.length>0||this.error.length>0||this.both.length>0}}),K.Property=u,f(u.prototype,{__name:"Property",__onActivation:function(){},__onDeactivation:function(){},__setActive:function(a){this.__active!==a&&(this.__active=a,a?this.__onActivation():this.__onDeactivation())},__clear:function(){this.__setActive(!1),this.__subscribers=null,this.__ended=!0},__send:function(a,b){this.__ended||("end"===a?(this.__subscribers.call("end",[]),this.__clear()):(this.__current[a]=b,this.__subscribers.call(a,[b]),this.__subscribers.call("both",[a,b])))},on:function(a,b){return this.__ended?"end"===a&&s.call(b):(this.__subscribers.add(a,b),"end"!==a&&this.__setActive(!0)),this},off:function(a,b){return this.__ended||(this.__subscribers.remove(a,b),"end"===a||this.__subscribers.hasValueOrError()||this.__setActive(!1)),this},watch:function(a,b){return"both"===a?(this.has("value")&&s.call(b,["value",this.get("value"),!0]),this.has("error")&&s.call(b,["error",this.get("error"),!0])):this.has(a)&&s.call(b,[this.get(a),!0]),this.on(a,b)},has:function(a){return"value"===a||"error"===a?this.__current[a]!==H:!1},get:function(a,b){return this.has(a)?this.__current[a]:b},isEnded:function(){return this.__ended},isActive:function(){return this.__active},toString:function(){return"["+this.__name+"]"}}),u.prototype.log=function(a){return null==a&&(a=this.toString()),this.watch("both",function(b,c,d){console.log(a,"<"+b+(d?":initial":"")+">",c)}),this.on("end",function(){console.log(a,"<end>")}),this},g(v,u,{__name:"FromBinderProperty",__onActivation:function(){var a=this;this.__unsubscribe=s.call(this.__fn,[function(b,c){a.__send(b,c)}])},__onDeactivation:function(){p(this.__unsubscribe)&&this.__unsubscribe(),this.__unsubscribe=null},__clear:function(){u.prototype.__clear.call(this),this.__fn=null}}),K.fromBinder=function(a){return new v(a)},g(w,u,{__name:"EmitterProperty",emit:function(a,b){this.__send(a,b)}}),K.emitter=function(){return new w};var L=new u;L.__send("end"),L.__name="NeverProperty",K.empty=function(){return L},g(x,u,{__name:"ConstantProperty"}),K.constant=function(a){return new x(a)},g(y,u,{__name:"ConstantErrorProperty"}),K.constantError=function(a){return new y(a)},A("withHandler",{__init:function(a){var b=this;this.__handler=new s(a[0]),this.__bindedSend=function(a,c){b.__send(a,c)}},__free:function(){this.__handler=null,this.__bindedSend=null},__handleValue:function(a,b){s.call(this.__handler,[this.__bindedSend,"value",a,b])},__handleError:function(a,b){s.call(this.__handler,[this.__bindedSend,"error",a,b])},__handleEnd:function(){s.call(this.__handler,[this.__bindedSend,"end"])}}),A("removeCurrent",{__init:function(a){this.__type=a[0]||"both"},__handleValue:function(a,b){(!b||"value"!==this.__type&&"both"!==this.__type)&&this.__send("value",a)},__handleError:function(a,b){(!b||"error"!==this.__type&&"both"!==this.__type)&&this.__send("error",a)}}),A("addCurrent",{__init:function(a){this.__type=a[0],this.__send(a[0],a[1])},__handleValue:function(a,b){b&&"value"===this.__type||this.__send("value",a)},__handleError:function(a,b){b&&"error"===this.__type||this.__send("error",a)}}),A("map",{__init:function(a){this.__fn=new s(a[0])},__free:function(){this.__fn=null},__handleValue:function(a){this.__send("value",s.call(this.__fn,[a]))}}),A("filter",{__init:function(a){this.__fn=new s(a[0])},__free:function(){this.__fn=null},__handleValue:function(a){s.call(this.__fn,[a])&&this.__send("value",a)}}),A("diff",{__init:function(a){this.__prev=a[0],this.__fn=new s(m(a,1))},__free:function(){this.__prev=null,this.__fn=null},__handleValue:function(a){this.__send("value",s.call(this.__fn,[this.__prev,a])),this.__prev=a}}),A("takeWhile",{__init:function(a){this.__fn=new s(a[0])},__free:function(){this.__fn=null},__handleValue:function(a){s.call(this.__fn,[a])?this.__send("value",a):this.__send("end")}}),A("take",{__init:function(a){this.__n=a[0],this.__n<=0&&this.__send("end")},__handleValue:function(a){this.__n--,this.__send("value",a),0===this.__n&&this.__send("end")}}),A("skip",{__init:function(a){this.__n=a[0]},__handleValue:function(a){this.__n<=0?this.__send("value",a):this.__n--}}),A("skipDuplicates",{__init:function(a){this.__fn=a.length>0?new s(a[0]):z,this.__prev=H},__free:function(){this.__fn=null,this.__prev=null},__handleValue:function(a){this.__prev!==H&&s.call(this.__fn,[this.__prev,a])||this.__send("value",a),this.__prev=a}}),A("skipWhile",{__init:function(a){this.__fn=new s(a[0]),this.__skip=!0},__free:function(){this.__fn=null},__handleValue:function(a){return this.__skip?void(s.call(this.__fn,[a])||(this.__skip=!1,this.__fn=null,this.__send("value",a))):void this.__send("value",a)}}),A("scan",{__init:function(a){this.__send("value",a[0]),this.__fn=new s(m(a,1))},__free:function(){this.__fn=null},__handleValue:function(a){this.__send("value",s.call(this.__fn,[this.get("value"),a]))}}),A("reduce",{__init:function(a){this.__result=a[0],this.__fn=new s(m(a,1))},__free:function(){this.__fn=null,this.__result=null},__handleValue:function(a){this.__result=s.call(this.__fn,[this.__result,a])},__handleEnd:function(){this.__send("value",this.__result),this.__send("end")}}),A("throttle",{__init:function(a){this.__wait=a[0],this.__leading=c(a[1],"leading",!0),this.__trailing=c(a[1],"trailing",!0),this.__trailingCallValue=null,this.__trailingCallTimeoutId=null,this.__endAfterTrailingCall=!1,this.__lastCallTime=0;var b=this;this.__makeTrailingCallBinded=function(){b.__makeTrailingCall()}},__free:function(){this.__trailingCallValue=null,this.__makeTrailingCallBinded=null},__handleValue:function(a,b){if(b)return void this.__send("value",a);var c=I();0!==this.__lastCallTime||this.__leading||(this.__lastCallTime=c);var d=this.__wait-(c-this.__lastCallTime);0>=d?(this.__cancelTralingCall(),this.__lastCallTime=c,this.__send("value",a)):this.__trailing&&this.__scheduleTralingCall(a,d)},__handleEnd:function(){this.__trailingCallTimeoutId?this.__endAfterTrailingCall=!0:this.__send("end")},__scheduleTralingCall:function(a,b){this.__trailingCallTimeoutId&&this.__cancelTralingCall(),this.__trailingCallValue=a,this.__trailingCallTimeoutId=setTimeout(this.__makeTrailingCallBinded,b)},__cancelTralingCall:function(){null!==this.__trailingCallTimeoutId&&(clearTimeout(this.__trailingCallTimeoutId),this.__trailingCallTimeoutId=null)},__makeTrailingCall:function(){this.__send("value",this.__trailingCallValue),this.__trailingCallTimeoutId=null,this.__trailingCallValue=null,this.__lastCallTime=this.__leading?I():0,this.__endAfterTrailingCall&&this.__send("end")}}),A("delay",{__init:function(a){this.__wait=a[0]},__handleValue:function(a,b){if(b)return void this.__send("value",a);var c=this;setTimeout(function(){c.__send("value",a)},this.__wait)},__handleEnd:function(){var a=this;setTimeout(function(){a.__send("end")},this.__wait)}}),E("merge",{__init:function(a){var b=h(a);b.length>0?(this.__multSubscriber.addAll(b),this.__multSubscriber.onLastRemoved([this.__send,this,"end"])):this.__send("end")}}),u.prototype.merge=function(a){return K.merge([this,a])},E("combine",{__init:function(a){this.__sources=a[0],this.__fn=a[1]?new s(a[1]):null,this.__sources.length>0?(this.__multSubscriber.addAll(this.__sources),this.__multSubscriber.onLastRemoved([this.__send,this,"end"])):this.__send("end")},__free:function(){this.__sources=null,this.__fn=null},__handleValue:function(){C(this.__sources)&&(this.__fn?this.__send("value",s.call(this.__fn,D(this.__sources))):this.__send("value",D(this.__sources)))}}),u.prototype.combine=function(a,b){return K.combine([this,a],b)};var M=E("flatMap",{__init:function(a){this.__source=a[0],this.__fn=a[1]?new s(a[1]):null,this.__multSubscriber.onLastRemoved([this.__endIfSourceEnded,this]),this.__source.on("end",[this.__endIfNoSubSources,this]),this.__source.has("value")&&this.__onValue(this.__source.get("value")),this.__source.has("error")&&this.__onError(this.__source.get("error"))},__free:function(){this.__source=null,this.__fn=null},__onActivationHook:function(){this.__source.on("both",[this.__onBoth,this])},__onDeactivationHook:function(){this.__source.off("both",[this.__onBoth,this])},__onValue:function(a){this.__multSubscriber.add(this.__fn?s.call(this.__fn,[a]):a)},__onError:function(a){this.__send("error",a)},__onBoth:function(a,b){"value"===a?this.__onValue(b):this.__onError(b)},__endIfSourceEnded:function(){this.__source.isEnded()&&this.__send("end")},__endIfNoSubSources:function(){this.__multSubscriber.hasProperties()||this.__send("end")}},!1);u.prototype.flatMap=function(a){return new M([this,a])},g(B,M,{__name:"FlatMapLatestProperty",__onValue:function(a){this.__multSubscriber.removeAll(),M.prototype.__onValue.call(this,a)}}),u.prototype.flatMapLatest=function(a){return new B([this,a])},E("pool",{add:function(a){this.__multSubscriber.add(a)},remove:function(a){this.__multSubscriber.remove(a)}}),E("sampledBy",{__init:function(a){var b=a[0],c=a[1];this.__allSources=k(b,c),this.__sourcesSubscriber=new F([this.__passErrors,this]),this.__sourcesSubscriber.addAll(b),this.__fn=a[2]?new s(a[2]):null,c.length>0?(this.__multSubscriber.addAll(c),this.__multSubscriber.onLastRemoved([this.__send,this,"end"])):this.__send("end")},__passErrors:function(a,b){"error"===a&&this.__send(a,b)},__free:function(){this.__allSources=null,this.__sourcesSubscriber.clear(),this.__sourcesSubscriber=null,this.__fn=null},__handleValue:function(){C(this.__allSources)&&(this.__fn?this.__send("value",s.call(this.__fn,D(this.__allSources))):this.__send("value",D(this.__allSources)))},__onActivationHook:function(){this.__sourcesSubscriber.start()},__onDeactivationHook:function(){this.__sourcesSubscriber.stop()}}),u.prototype.sampledBy=function(a,c){return K.sampledBy([this],[a],c||b)},f(F.prototype,{start:function(){if(!this.active){for(var a=0;a<this.properties.length;a++)this.properties[a].on("both",this.listener);this.active=!0}},stop:function(){if(this.active){for(var a=0;a<this.properties.length;a++)this.properties[a].off("both",this.listener);this.active=!1}},addAll:function(a){for(var b=0;b<a.length;b++)this.add(a[b])},add:function(a){this.properties.push(a),a.on("end",[this.remove,this,a]),a.has("value")&&s.call(this.listener,["value",a.get("value"),!0]),a.has("error")&&s.call(this.listener,["error",a.get("error"),!0]),this.active&&a.on("both",this.listener)},remove:function(a){for(var b=0;b<this.properties.length;b++)if(this.properties[b]===a){this.properties.splice(b,1),a.off("end",[this.remove,this,a]),this.active&&a.off("both",this.listener);break}0===this.properties.length&&this.onLastRemovedCb&&s.call(this.onLastRemovedCb)},removeAll:function(){for(var a=0;a<this.properties.length;a++)this.properties[a].off("end",[this.remove,this,this.properties[a]]),this.active&&this.properties[a].off("both",this.listener);this.properties=[],this.onLastRemovedCb&&s.call(this.onLastRemovedCb)},onLastRemoved:function(a){this.onLastRemovedCb=new s(a)},offLastRemoved:function(){this.onLastRemovedCb=null},hasProperties:function(){return this.properties.length>0},clear:function(){this.offLastRemoved(),this.removeAll()}}),G("withInterval",{__init:function(a){this.__fn=new s(a[0]);var b=this;this.__bindedSend=function(a,c){b.__send(a,c)}},__free:function(){this.__fn=null,this.__bindedSend=null},__onTick:function(){s.call(this.__fn,[this.__bindedSend])}}),G("fromPoll",{__init:function(a){this.__fn=new s(a[0])},__free:function(){this.__fn=null},__onTick:function(){this.__send("value",s.call(this.__fn))}}),G("interval",{__init:function(a){this.__x=a[0]},__free:function(){this.__x=null},__onTick:function(){this.__send("value",this.__x)}}),G("sequentially",{__init:function(a){this.__xs=l(a[0]),0===this.__xs.length&&this.__send("end")},__free:function(){this.__xs=null},__onTick:function(){switch(this.__xs.length){case 0:this.__send("end");break;case 1:this.__send("value",this.__xs[0]),this.__send("end");break;default:this.__send("value",this.__xs.shift())}}}),G("repeatedly",{__init:function(a){this.__xs=l(a[0]),this.__i=-1},__onTick:function(){this.__xs.length>0&&(this.__i=(this.__i+1)%this.__xs.length,this.__send("value",this.__xs[this.__i]))}}),G("later",{__init:function(a){this.__x=a[0]},__free:function(){this.__x=null},__onTick:function(){this.__send("value",this.__x),this.__send("end")}}),"function"==typeof define&&define.amd?(define([],function(){return K}),a.Kefir=K):"object"==typeof module&&"object"==typeof exports?(module.exports=K,K.Kefir=K):a.Kefir=K}(this);