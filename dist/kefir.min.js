/*! kefir - 0.1.12
 *  https://github.com/pozadi/kefir
 */
!function(a){"use strict";function b(){}function c(a,b,c){return a&&b in a?a[b]:c}function d(a,b){return Object.prototype.hasOwnProperty.call(a,b)}function e(a){return p(a)?a:Array.prototype.slice.call(a)}function f(a){var b=function(){};return b.prototype=a,new b}function g(){if(1===arguments.length)return arguments[0];for(var a=arguments[0],b=1;b<arguments.length;b++)for(var c in arguments[b])d(arguments[b],c)&&(a[c]=arguments[b][c]);return a}function h(a,b){a.prototype=f(b.prototype),a.prototype.constructor=a;for(var c=2;c<arguments.length;c++)g(a.prototype,arguments[c]);return a}function i(a){return 1===a.length&&p(a[0])?a[0]:e(a)}function j(a,b,c){return a.length>b?Array.prototype.slice.call(a,b):c}function k(a,b){if(n(a))return a;if(null!=b&&n(b[a]))return b[a];throw new Error("not a function: "+a+" in "+b)}function l(a,b,c){return null!=b?c&&0!==c.length?a.apply(b,c):a.call(b):c&&0!==c.length?1===c.length?a(c[0]):2===c.length?a(c[0],c[1]):3===c.length?a(c[0],c[1],c[2]):a.apply(null,c):a()}function m(a,b){return 1===a.length&&1===b.length?[a[0],b[0]]:2===a.length&&1===b.length?[a[0],a[1],b[0]]:3===a.length&&1===b.length?[a[0],a[1],a[2],b[0]]:a.concat(b)}function n(a){return"function"==typeof a}function o(a){return"undefined"==typeof a}function p(a){return"[object Array]"===Object.prototype.toString.call(a)}function q(a,b){if(null==a&&null==b)return!0;if(null==a||null==b)return!1;if(a.length!==b.length)return!1;for(var c=0;c<a.length;c++)if(a[c]!==b[c])return!1;return!0}function r(a){this.error=a}function s(a){if(n(a)||a instanceof s)return a;if(!a||!a.length)throw new Error("can't convert to Callable "+a);if(1===a.length){if(n(a[0]))return a[0];throw new Error("can't convert to Callable "+a)}this.fn=k(a[0],a[1]),this.context=a[1],this.args=j(a,2,null)}function t(a,b,c){console.log(a,b,c)}function u(a){N.call(this),this.__value=a}function v(a){O.call(this,a),this.__sendEnd()}function w(a){N.call(this),this.__subscribeFn=new s(a)}function x(a,b,c){function d(a,b){N.call(this),this.__source=a,this.__init(b),this.__afterInitial(b),a.onEnd(this.__handleEnd,this)}function e(a,b){O.call(this),this.__source=a,this.__init(b),a instanceof O&&a.hasValue()&&this.__handleValue(a.getValue(),!0),this.__afterInitial(b),a.onEnd(this.__handleEnd,this)}var f={__init:function(){},__afterInitial:function(){},__free:function(){},__handleValue:function(a){this.__sendValue(a)},__handleError:function(a){this.__sendError(a)},__handleEnd:function(){this.__sendEnd()}},i=g({__handleErrorOrValue:function(a,b){"value"===a?this.__handleValue(b):this.__handleError(b)},__onFirstIn:function(){this.__source.onNewBoth(this.__handleErrorOrValue,this)},__onLastOut:function(){this.__source.offBoth(this.__handleErrorOrValue,this)}},f,c);return h(d,N,i,{__ClassName:a+"Stream",__clear:function(){N.prototype.__clear.call(this),this.__source=null,this.__free()}}),h(e,O,i,{__ClassName:a+"Property",__clear:function(){O.prototype.__clear.call(this),this.__source=null,this.__free()}}),b&&(N.prototype[b]=function(){return new d(this,arguments)},O.prototype[b]=function(){return new e(this,arguments)}),{Stream:d,Property:e}}function y(a,b){return a===b}function z(){this.__Constructor.apply(this,arguments)}function A(){this.__Constructor.apply(this,arguments)}function B(){N.call(this),this.__initPluggable()}function C(a,b){N.call(this),this.__initPluggable(),this.__sourceStream=a,this.__mapFn=new s(b),a.onEnd(this.__onSourceEnds,this)}function D(){C.apply(this,arguments)}function E(){N.call(this),this.__initPluggable();for(var a=i(arguments),b=0;b<a.length;b++)this.__plug(a[b])}function F(a,b){N.call(this),this.__plugged=a;for(var c=0;c<this.__plugged.length;c++)a[c].onEnd(this.__unplugById,this,c);this.__cachedValues=new Array(a.length),this.__hasValue=new Array(a.length),this.__mapFn=b&&new s(b)}function G(a,b,c){function d(a,b){N.call(this),this.__wait=a,this.__intervalId=null;var c=this;this.__bindedOnTick=function(){c.__onTick()},this.__init(b)}var e={__init:function(){},__free:function(){},__onTick:function(){}},f=g({__onFirstIn:function(){this.__intervalId=setInterval(this.__bindedOnTick,this.__wait)},__onLastOut:function(){null!==this.__intervalId&&(clearInterval(this.__intervalId),this.__intervalId=null)}},e,c);return h(d,N,f,{__ClassName:a+"Stream",__clear:function(){N.prototype.__clear.call(this),this.__bindedOnTick=null,this.__free()}}),b&&(J[b]=function(a){return new d(a,j(arguments,1,[]))}),d}var H=function(a){return"[object Arguments]"===Object.prototype.toString.call(a)};H(arguments)||(H=function(a){return!(!a||!d(a,"callee"))});var I=Date.now?function(){return Date.now()}:function(){return(new Date).getTime()},J={},K=J.NOTHING=["<nothing>"],L=J.END=["<end>"];J.error=function(a){return new r(a)},s.call=function(a,b){return n(a)?l(a,null,b):a instanceof s?(a.args&&(b=b?m(a.args,b):a.args),l(a.fn,a.context,b)):s.call(new s(a),b)},s.callAll=function(a,b){if(null!==a&&0!==a.length)if(1===a.length)s.call(a[0],b);else{a=a.slice(0);for(var c=0,d=a.length;d>c;c++)s.call(a[c],b)}},s.isEqual=function(a,b){return a===b?!0:(a=new s(a),b=new s(b),n(a)||n(b)?a===b:a.fn===b.fn&&a.context===b.context&&q(a.args,b.args))};var M=J.Observable=function(){this.__subscribers={value:null,error:null,both:null,end:null},this.alive=!0,this.active=!1};h(M,Object,{__ClassName:"Observable",toString:function(){return"["+this.__ClassName+(this.__objName?" | "+this.__objName:"")+"]"},__onFirstIn:b,__onLastOut:b,__addSubscriber:function(a,b){null===this.__subscribers[a]&&(this.__subscribers[a]=[]),this.__subscribers[a].push(new s(b))},__removeSubscriber:function(a,b){var c=this.__subscribers[a];if(null!==c)for(var d=new s(b),e=0;e<c.length;e++)if(s.isEqual(c[e],d))return void c.splice(e,1)},__on:function(a,b){this.alive?(this.__addSubscriber(a,b),this.active||"end"===a||(this.active=!0,this.__onFirstIn())):"end"===a&&s.call(b)},__off:function(a,b){this.alive&&(this.__removeSubscriber(a,b),this.active&&"end"!==a&&!this.__hasSubscribers()&&(this.active=!1,this.__onLastOut()))},__send:function(a,b){this.alive&&("end"===a?(s.callAll(this.__subscribers.end,[]),this.__clear()):this.active&&(s.callAll("value"===a?this.__subscribers.value:this.__subscribers.error,[b]),s.callAll(this.__subscribers.both,[a,b])))},__hasSubscribers:function(){var a=this.__subscribers;return null!==a.value&&a.value.length>0||null!==a.error&&a.error.length>0||null!==a.both&&a.both.length>0},__clear:function(){this.active&&(this.active=!1,this.__onLastOut()),this.__subscribers=null,this.alive=!1},__sendValue:function(a){return this.__send("value",a),this},__sendError:function(a){return this.__send("error",a),this},__sendEnd:function(){return this.__send("end"),this},__sendAny:function(a){return a===K?this:a===L?(this.__sendEnd(),this):a instanceof r?(this.__sendError(a.error),this):(this.__sendValue(a),this)},onValue:function(){return this.__on("value",arguments),this},onError:function(){return this.__on("error",arguments),this},onBoth:function(){return this.__on("both",arguments),this},onEnd:function(){return this.__on("end",arguments),this},offValue:function(){return this.__off("value",arguments),this},offError:function(){return this.__off("error",arguments),this},offBoth:function(){return this.__off("both",arguments),this},offEnd:function(){return this.__off("end",arguments),this},isEnded:function(){return!this.alive}});var N=J.Stream=function(){M.call(this)};h(N,M,{__ClassName:"Stream"});var O=J.Property=function(a){M.call(this),this.__cached=o(a)?K:a};h(O,M,{__ClassName:"Property",hasValue:function(){return this.__cached!==K},getValue:function(){return this.__cached},__sendValue:function(a){this.alive&&(this.__cached=a),M.prototype.__sendValue.call(this,a)},onNewValue:function(){return this.__on("value",arguments),this},onValue:function(){return this.hasValue()&&s.call(arguments,[this.getValue()]),this.onNewValue.apply(this,arguments)},onNewBoth:function(){return this.__on("both",arguments),this},onBoth:function(){return this.hasValue()&&s.call(arguments,["value",this.getValue()]),this.onNewBoth.apply(this,arguments)}}),g(N.prototype,{onNewValue:function(){return this.onValue.apply(this,arguments)},onNewBoth:function(){return this.onBoth.apply(this,arguments)}}),M.prototype.log=function(a){return null==a&&(a=this.toString()),this.onValue(t,null,a,"<value>"),this.onError(t,null,a,"<error>"),this.onEnd(t,null,a,"<end>"),this};var P=new N;P.__sendEnd(),P.__ClassName="NeverStream",J.never=function(){return P},h(u,N,{__ClassName:"OnceStream",onValue:function(){return this.alive&&(s.call(arguments,[this.__value]),this.__value=null,this.__sendEnd()),this},onBoth:function(){return this.alive&&(s.call(arguments,["value",this.__value]),this.__value=null,this.__sendEnd()),this},onError:b}),J.once=function(a){return new u(a)},h(v,O,{__ClassName:"ConstantProperty"}),J.constant=function(a){return new v(a)},h(w,N,{__ClassName:"FromBinderStream",__onFirstIn:function(){var a=this;this.__unsubscribe=s.call(this.__subscribeFn,[function(b){a.__sendAny(b)}])},__onLastOut:function(){n(this.__unsubscribe)&&this.__unsubscribe(),this.__unsubscribe=null},__clear:function(){N.prototype.__clear.call(this),this.__subscribeFn=null}}),J.fromBinder=function(){return new w(arguments)},x("Mapped","map",{__init:function(a){this.__fn=new s(a)},__free:function(){this.__fn=null},__handleValue:function(a){this.__sendAny(s.call(this.__fn,[a]))}}),x("Filtered","filter",{__init:function(a){this.__fn=new s(a)},__free:function(){this.__fn=null},__handleValue:function(a){s.call(this.__fn,[a])&&this.__sendValue(a)}}),x("Diff","diff",{__init:function(a){this.__prev=a[0],this.__fn=new s(j(a,1))},__free:function(){this.__prev=null,this.__fn=null},__handleValue:function(a){this.__sendValue(s.call(this.__fn,[this.__prev,a])),this.__prev=a}}),x("TakeWhile","takeWhile",{__init:function(a){this.__fn=new s(a)},__free:function(){this.__fn=null},__handleValue:function(a){s.call(this.__fn,[a])?this.__sendValue(a):this.__sendEnd()}}),x("Take","take",{__init:function(a){this.__n=a[0],this.__n<=0&&this.__sendEnd()},__handleValue:function(a){this.__n--,this.__sendValue(a),0===this.__n&&this.__sendEnd()}}),x("Skip","skip",{__init:function(a){this.__n=a[0]},__handleValue:function(a){this.__n<=0?this.__sendValue(a):this.__n--}}),x("SkipDuplicates","skipDuplicates",{__init:function(a){this.__fn=a.length>0?new s(a):y,this.__prev=K},__free:function(){this.__fn=null,this.__prev=null},__handleValue:function(a){this.__prev!==K&&s.call(this.__fn,[this.__prev,a])||this.__sendValue(a),this.__prev=a}}),x("SkipWhile","skipWhile",{__init:function(a){this.__fn=new s(a),this.__skip=!0},__free:function(){this.__fn=null},__handleValue:function(a){return this.__skip?void(s.call(this.__fn,[a])||(this.__skip=!1,this.__fn=null,this.__sendValue(a))):void this.__sendValue(a)}});var Q=x("Changes").Stream;N.prototype.changes=function(){return this},O.prototype.changes=function(){return new Q(this)};var R=x("ToProperty",null,{__afterInitial:function(a){a===K||o(a)||this.__sendValue(a)}}).Property;N.prototype.toProperty=function(a){return new R(this,a)},O.prototype.toProperty=function(a){return o(a)||a===K?this:new R(this,a)};var S=x("Scan",null,{__init:function(a){this.__sendValue(a[0]),this.__fn=new s(j(a,1))},__free:function(){this.__fn=null},__handleValue:function(a){this.__sendValue(s.call(this.__fn,[this.getValue(),a]))}}).Property;M.prototype.scan=function(){return new S(this,arguments)};var T=x("Reduced",null,{__init:function(a){this.__result=a[0],this.__fn=new s(j(a,1))},__free:function(){this.__fn=null,this.__result=null},__handleValue:function(a){this.__result=s.call(this.__fn,[this.__result,a])},__handleEnd:function(){this.__sendValue(this.__result),this.__sendEnd()}}).Property;M.prototype.reduce=function(){return new T(this,arguments)},x("Throttled","throttle",{__init:function(a){this.__wait=a[0],this.__leading=c(a[1],"leading",!0),this.__trailing=c(a[1],"trailing",!0),this.__trailingCallValue=null,this.__trailingCallTimeoutId=null,this.__endAfterTrailingCall=!1,this.__lastCallTime=0;var b=this;this.__makeTrailingCallBinded=function(){b.__makeTrailingCall()}},__free:function(){this.__trailingCallValue=null,this.__makeTrailingCallBinded=null},__handleValue:function(a,b){if(b)return void this.__sendValue(a);var c=I();0!==this.__lastCallTime||this.__leading||(this.__lastCallTime=c);var d=this.__wait-(c-this.__lastCallTime);0>=d?(this.__cancelTralingCall(),this.__lastCallTime=c,this.__sendValue(a)):this.__trailing&&this.__scheduleTralingCall(a,d)},__handleEnd:function(){this.__trailingCallTimeoutId?this.__endAfterTrailingCall=!0:this.__sendEnd()},__scheduleTralingCall:function(a,b){this.__trailingCallTimeoutId&&this.__cancelTralingCall(),this.__trailingCallValue=a,this.__trailingCallTimeoutId=setTimeout(this.__makeTrailingCallBinded,b)},__cancelTralingCall:function(){null!==this.__trailingCallTimeoutId&&(clearTimeout(this.__trailingCallTimeoutId),this.__trailingCallTimeoutId=null)},__makeTrailingCall:function(){this.__sendValue(this.__trailingCallValue),this.__trailingCallTimeoutId=null,this.__trailingCallValue=null,this.__lastCallTime=this.__leading?I():0,this.__endAfterTrailingCall&&this.__sendEnd()}}),x("Delayed","delay",{__init:function(a){this.__wait=a[0]},__handleValue:function(a,b){if(b)return void this.__sendValue(a);var c=this;setTimeout(function(){c.__sendValue(a)},this.__wait)},__handleEnd:function(){var a=this;setTimeout(function(){a.__sendEnd()},this.__wait)}});var U={__Constructor:function(a){this.__source=a,a.onEnd(this.__sendEnd,this),a instanceof O&&this instanceof O&&a.hasValue()&&this.__handle(a.getValue())},__handle:function(a){this.__sendAny(a)},__handleBoth:function(a,b){"value"===a?this.__handle(b):this.__sendError(b)},__onFirstIn:function(){this.__source.onNewBoth(this.__handleBoth,this)},__onLastOut:function(){this.__source.offBoth(this.__handleBoth,this)},__clear:function(){M.prototype.__clear.call(this),this.__source=null}},V={__Constructor:function(a,b,c){this instanceof O?O.call(this):N.call(this),this.__transformer=c&&new s(c),this.__mainStream=a,this.__lastValue=K,a instanceof O&&a.hasValue()&&(this.__lastValue=a.getValue()),U.__Constructor.call(this,b)},__handle:function(a){if(this.__lastValue!==K){var b=this.__lastValue;this.__transformer&&(b=s.call(this.__transformer,[b,a])),this.__sendValue(b)}},__handleMainBoth:function(a,b){"value"===a?this.__lastValue=b:this.__sendError(b)},__onFirstIn:function(){U.__onFirstIn.call(this),this.__mainStream.onBoth(this.__handleMainBoth,this)},__onLastOut:function(){U.__onLastOut.call(this),this.__mainStream.offBoth(this.__handleMainBoth,this)},__clear:function(){U.__clear.call(this),this.__lastValue=null,this.__fn=null,this.__mainStream=null}};V=g({},U,V),h(z,N,V,{__ClassName:"SampledByStream"}),h(A,O,V,{__ClassName:"SampledByProperty"}),M.prototype.sampledBy=function(a){return a instanceof N?new z(this,a,j(arguments,1)):new A(this,a,j(arguments,1))};var W={__initPluggable:function(){this.__plugged=[]},__clearPluggable:function(){this.__plugged=null},__handlePluggedBoth:function(a,b){"value"===a?this.__sendAny(b):this.__sendError(b)},__plug:function(a){this.alive&&(this.__plugged.push(a),this.active&&a.onBoth(this.__handlePluggedBoth,this),a.onEnd("__unplug",this,a))},__unplug:function(a){if(this.alive)for(var b=0;b<this.__plugged.length;b++)if(a===this.__plugged[b])return a.offBoth(this.__handlePluggedBoth,this),a.offEnd("__unplug",this,a),void this.__plugged.splice(b,1)},__onFirstIn:function(){for(var a=0;a<this.__plugged.length;a++){var b=this.__plugged[a];b&&b.onBoth(this.__handlePluggedBoth,this)}},__onLastOut:function(){for(var a=0;a<this.__plugged.length;a++){var b=this.__plugged[a];b&&b.offBoth(this.__handlePluggedBoth,this)}},__hasNoPlugged:function(){return!this.alive||0===this.__plugged.length}};h(B,N,W,{__ClassName:"Bus",push:function(a){return this.__sendAny(a),this},error:function(a){return this.__sendError(a),this},plug:function(a){return this.__plug(a),this},unplug:function(a){return this.__unplug(a),this},end:function(){return this.__sendEnd(),this},__clear:function(){N.prototype.__clear.call(this),this.__clearPluggable()}}),J.bus=function(){return new B},h(C,N,W,{__ClassName:"FlatMappedStream",__onSourceEnds:function(){this.__hasNoPlugged()&&this.__sendEnd()},__plugResult:function(a){this.__plug(s.call(this.__mapFn,[a]))},__hadleSourceBoth:function(a,b){"value"===a?this.__plugResult(b):this.__sendError(b)},__onFirstIn:function(){this.__sourceStream.onBoth(this.__hadleSourceBoth,this),W.__onFirstIn.call(this)},__onLastOut:function(){this.__sourceStream.offBoth(this.__hadleSourceBoth,this),W.__onLastOut.call(this)},__unplug:function(a){W.__unplug.call(this,a),this.alive&&this.__sourceStream.isEnded()&&this.__hasNoPlugged()&&this.__sendEnd()},__clear:function(){N.prototype.__clear.call(this),this.__clearPluggable(),this.__sourceStream=null,this.__mapFn=null}}),M.prototype.flatMap=function(){return new C(this,arguments)},h(D,C,{__ClassName:"FlatMapLatestStream",__plugResult:function(a){1===this.__plugged.length&&this.__unplug(this.__plugged[0]),C.prototype.__plugResult.call(this,a)}}),M.prototype.flatMapLatest=function(){return new D(this,arguments)},h(E,N,W,{__ClassName:"MergedStream",__clear:function(){N.prototype.__clear.call(this),this.__clearPluggable()},__unplug:function(a){W.__unplug.call(this,a),this.__hasNoPlugged()&&this.__sendEnd()}}),J.merge=function(){return new E(i(arguments))},M.prototype.merge=function(){return J.merge([this].concat(i(arguments)))},h(F,N,{__ClassName:"CombinedStream",__onFirstIn:function(){for(var a=0;a<this.__plugged.length;a++){var b=this.__plugged[a];b&&b.onBoth(this.__handlePluggedBoth,this,a)}},__onLastOut:function(){for(var a=0;a<this.__plugged.length;a++){var b=this.__plugged[a];b&&b.offBoth(this.__handlePluggedBoth,this,a)}},__hasNoPlugged:function(){if(!this.alive)return!0;for(var a=0;a<this.__plugged.length;a++)if(this.__plugged[a])return!1;return!0},__unplugById:function(a){var b=this.__plugged[a];b&&(this.__plugged[a]=null,b.offBoth(this.__handlePluggedBoth,this,a),b.offEnd(this.__unplugById,this,a),this.__hasNoPlugged()&&this.__sendEnd())},__handlePluggedBoth:function(a,b,c){"value"===b?(this.__hasValue[a]=!0,this.__cachedValues[a]=c,this.__allCached()&&(this.__mapFn?this.__sendAny(s.call(this.__mapFn,this.__cachedValues)):this.__sendValue(this.__cachedValues.slice(0)))):this.__sendError(c)},__allCached:function(){for(var a=0;a<this.__hasValue.length;a++)if(!this.__hasValue[a])return!1;return!0},__clear:function(){N.prototype.__clear.call(this),this.__plugged=null,this.__cachedValues=null,this.__hasValue=null,this.__mapFn=null}}),J.combine=function(a){return new F(a,j(arguments,1))},M.prototype.combine=function(a){return new F([this].concat(a),j(arguments,1))},J.onValues=function(a){var b=new s(j(arguments,1));return J.combine(a).onValue(function(a){return s.call(b,a)})},G("Tiks","tiks",{__onTick:function(){this.__sendValue()}}),G("FromPoll","fromPoll",{__init:function(a){this.__fn=new s(a)},__free:function(){this.__fn=null},__onTick:function(){this.__sendAny(s.call(this.__fn))}}),G("Interval","interval",{__init:function(a){this.__x=a.length>0?a[0]:void 0},__free:function(){this.__x=null},__onTick:function(){void 0===this.__x?this.__sendValue():this.__sendAny(this.__x)}}),G("Sequentially","sequentially",{__init:function(a){this.__xs=a[0].slice(0)},__free:function(){this.__xs=null},__onTick:function(){return 0===this.__xs.length?void this.__sendEnd():(this.__sendAny(this.__xs.shift()),void(0===this.__xs.length&&this.__sendEnd()))}}),G("Repeatedly","repeatedly",{__init:function(a){this.__xs=a[0].slice(0),this.__i=-1},__onTick:function(){this.__i=(this.__i+1)%this.__xs.length,this.__sendAny(this.__xs[this.__i])}}),G("Later","later",{__init:function(a){this.__x=a[0]},__free:function(){this.__x=null},__onTick:function(){this.__sendAny(this.__x),this.__sendEnd()}}),"function"==typeof define&&define.amd?(define([],function(){return J}),a.Kefir=J):"object"==typeof module&&"object"==typeof exports?(module.exports=J,J.Kefir=J):a.Kefir=J}(this);